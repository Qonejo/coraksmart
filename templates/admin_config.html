<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuración - Panel Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Press Start 2P', cursive; background-color: #222; color: #fff; padding: 20px; }
        h1, h2, h3 { border-bottom: 2px solid #fff; padding-bottom: 10px; }
        .config-container { max-width: 600px; margin: 20px auto; padding: 20px; background: #1a1a1a; border: 4px solid #00ff00; border-radius: 10px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; color: #00ff00; margin-bottom: 8px; font-size: 12px; }
        .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 10px; background: #333; border: 2px solid #555; color: #fff; border-radius: 5px; font-family: 'Press Start 2P', cursive; font-size: 10px; box-sizing: border-box; }
        .form-group input:focus, .form-group textarea:focus { border-color: #00ff00; outline: none; }
        .form-group textarea { height: 80px; resize: vertical; }
        .submit-btn { background: #003300; color: #00ff00; border: 2px solid #00ff00; padding: 12px 20px; border-radius: 5px; font-family: 'Press Start 2P', cursive; font-size: 10px; cursor: pointer; transition: all 0.3s ease; }
        .submit-btn:hover { background: #00ff00; color: #000; }
        .back-btn { display: inline-block; margin-bottom: 20px; padding: 8px 15px; background: #333; color: #00ff00; text-decoration: none; border: 2px solid #00ff00; border-radius: 5px; font-family: 'Press Start 2P', cursive; font-size: 9px; transition: all 0.3s ease; }
        .back-btn:hover { background: #00ff00; color: #000; }
        .help-text { font-size: 8px; color: #888; margin-top: 5px; line-height: 1.4; }
        .section-divider { margin-top: 40px; padding-top: 20px; border-top: 2px solid #333; }
    </style>
</head>
<body>
    <header>
        <div class="logo-container"><img src="{{ url_for('static', filename='logo.png') }}" alt="CorakSmart" style="height: 60px;"></div>
        <div class="user-info"><span>👑 Admin Panel</span></div>
    </header>

    <div class="config-container">
        <a href="{{ url_for('admin_view') }}" class="back-btn">← Volver al Panel</a>
        <h1 style="text-align: center; color: #00ff00; margin-bottom: 30px;">⚙️ Configuración General</h1>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                <div class="flash-message flash-{{ category }}" style="padding: 10px; margin-bottom: 15px; border-radius: 5px; background: {% if category == 'success' %}#28a745{% else %}#dc3545{% endif %}; color: white;">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <form method="POST" action="{{ url_for('admin_configuracion') }}">

            <!-- Configuración General -->
            <div class="form-group">
                <label for="horarios_atencion">📅 Horarios de Atención:</label>
                <textarea id="horarios_atencion" name="horarios_atencion" placeholder="Ej: Lunes a Viernes: 9:00 AM - 6:00 PM">{{ config.horarios_atencion }}</textarea>
            </div>
            
            <div class="form-group">
                <label for="whatsapp_principal">📱 WhatsApp Principal:</label>
                <input type="text" id="whatsapp_principal" name="whatsapp_principal" value="{{ config.whatsapp_principal }}" placeholder="521234567890">
            </div>
            
            <div class="form-group">
                <label for="whatsapp_secundario">📱 WhatsApp Secundario (Opcional):</label>
                <input type="text" id="whatsapp_secundario" name="whatsapp_secundario" value="{{ config.whatsapp_secundario }}" placeholder="521234567890">
            </div>
            
            <h3 style="color: #ffcc00; margin: 30px 0 20px 0; border-bottom: 2px solid #ffcc00; padding-bottom: 10px;">📱 Configuración WhatsApp por Producto</h3>
            
            <div class="form-group"><label for="whatsapp_1">📱 WhatsApp 1:</label><input type="text" id="whatsapp_1" name="whatsapp_1" value="{{ config.whatsapp_1 }}" placeholder="521234567890"></div>
            <div class="form-group"><label for="whatsapp_1_nombre">🏷️ Nombre WhatsApp 1:</label><input type="text" id="whatsapp_1_nombre" name="whatsapp_1_nombre" value="{{ config.whatsapp_1_nombre }}" placeholder="Principal"></div>
            <div class="form-group"><label for="whatsapp_2">📱 WhatsApp 2:</label><input type="text" id="whatsapp_2" name="whatsapp_2" value="{{ config.whatsapp_2 }}" placeholder="521234567890"></div>
            <div class="form-group"><label for="whatsapp_2_nombre">🏷️ Nombre WhatsApp 2:</label><input type="text" id="whatsapp_2_nombre" name="whatsapp_2_nombre" value="{{ config.whatsapp_2_nombre }}" placeholder="Secundario"></div>
            <div class="form-group"><label for="whatsapp_3">📱 WhatsApp 3:</label><input type="text" id="whatsapp_3" name="whatsapp_3" value="{{ config.whatsapp_3 }}" placeholder="521234567890"></div>
            <div class="form-group"><label for="whatsapp_3_nombre">🏷️ Nombre WhatsApp 3:</label><input type="text" id="whatsapp_3_nombre" name="whatsapp_3_nombre" value="{{ config.whatsapp_3_nombre }}" placeholder="Terciario"></div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button type="submit" name="action" value="save_config" class="submit-btn">💾 Guardar Configuración</button>
            </div>

            <!-- Acciones Administrativas -->
            <div class="section-divider">
                <h3 style="color: #ff6666; margin-bottom: 15px;">⚠️ Acciones Administrativas</h3>
                
                <div style="display: flex; flex-direction: column; gap: 20px;">
                    <!-- Reiniciar Contraseña -->
                    <div class="form-group">
                        <label style="color: #ff6666; font-size: 10px;">🔑 Reiniciar Contraseña de Usuario:</label>
                        <input type="text" name="reset_user_emoji" placeholder="Emoji del usuario (ej: 😀)">
                        <div class="help-text">La contraseña se reiniciará a un valor por defecto ('1234').</div>
                        <button type="submit" name="action" value="reset_password" onclick="return confirm('¿Estás seguro de reiniciar la contraseña de este usuario?')" class="submit-btn" style="background: #ff3333; border-color: #ff6666; color: #fff; margin-top: 10px;">🔄 Reiniciar Contraseña</button>
                    </div>

                    <!-- Borrar Pedidos -->
                    <div class="form-group">
                        <label style="color: #ff6666; font-size: 10px;">🗑️ Borrar Todos los Pedidos:</label>
                        <div style="background: #2a1a1a; padding: 10px; border: 2px solid #ff3333; border-radius: 5px; font-size: 8px; color: #ff6666;">
                            ⚠️ ADVERTENCIA: Esta acción es permanente e irreversible.
                        </div>
                        <button type="submit" name="action" value="clear_orders" onclick="return confirm('¿ESTÁS COMPLETAMENTE SEGURO? Esta acción eliminará TODOS los pedidos y NO SE PUEDE DESHACER.')" class="submit-btn" style="background: #aa0000; border-color: #ff3333; color: #fff; margin-top: 10px;">💥 BORRAR TODOS LOS PEDIDOS</button>
                    </div>

                    <!-- Resetear todos los usuarios -->
                    <div class="form-group">
                        <label style="color: #ff6666; font-size: 10px;">🔄 Resetear Todos los Usuarios y Contraseñas:</label>
                        <div style="background: #2a1a1a; padding: 10px; border: 2px solid #ff3333; border-radius: 5px; font-size: 8px; color: #ff6666;">
                            ⚠️ ADVERTENCIA: Esta acción reiniciará los puntos, niveles y contraseñas (el usuario deberá crear una nueva al iniciar sesión) de TODOS los usuarios. Es irreversible.
                        </div>
                        <button type="submit" name="action" value="reset_all_users" onclick="return confirm('¿ESTÁS COMPLETAMENTE SEGURO? Esta acción reiniciará a TODOS los usuarios y sus contraseñas. NO SE PUEDE DESHACER.')" class="submit-btn" style="background: #aa0000; border-color: #ff3333; color: #fff; margin-top: 10px;">💥 RESETEAR TODOS LOS USUARIOS</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</body>
</html>
